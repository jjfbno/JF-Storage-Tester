<Window x:Class="JFStorageTester.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:JFStorageTester.ViewModels"
        Title="Settings"
        Height="320" Width="400"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{DynamicResource PrimaryBackgroundBrush}">
    
    <Window.DataContext>
        <vm:SettingsViewModel/>
    </Window.DataContext>
    
    <Window.Resources>
        <!-- Toggle Switch Style -->
        <Style x:Key="ToggleSwitchStyle" TargetType="CheckBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid Cursor="Hand">
                            <Border x:Name="track"
                                    Width="40" Height="20"
                                    CornerRadius="10"
                                    Background="{DynamicResource BorderBrush}"/>
                            <Border x:Name="thumb"
                                    Width="16" Height="16"
                                    CornerRadius="8"
                                    Background="White"
                                    HorizontalAlignment="Left"
                                    Margin="2,0,0,0"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="track" Property="Background" Value="{DynamicResource AccentBrush}"/>
                                <Setter TargetName="thumb" Property="HorizontalAlignment" Value="Right"/>
                                <Setter TargetName="thumb" Property="Margin" Value="0,0,2,0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,12">
            <TextBlock Text="Settings" 
                       Style="{StaticResource HeaderTextStyle}"/>
            <TextBlock Text="Customize your experience"
                       Style="{StaticResource BodyTextStyle}"
                       Margin="0,2,0,0"/>
        </StackPanel>
        
        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto"
                      Style="{StaticResource MinimalScrollViewer}">
            <StackPanel>
                <!-- Appearance Section -->
                <Border Style="{StaticResource CardStyle}" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="APPEARANCE" 
                                   Style="{StaticResource LabelTextStyle}"
                                   Margin="0,0,0,10"/>
                        
                        <!-- Theme Toggle -->
                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel>
                                <TextBlock Text="Dark Mode"
                                           Style="{StaticResource SubheaderTextStyle}"/>
                                <TextBlock Text="Use dark colors for the interface"
                                           Style="{StaticResource BodyTextStyle}"/>
                            </StackPanel>
                            
                            <CheckBox Grid.Column="1" 
                                      IsChecked="{Binding IsDarkMode}"
                                      Style="{StaticResource ToggleSwitchStyle}"
                                      VerticalAlignment="Center"/>
                        </Grid>
                        
                        <!-- Follow System Theme -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel>
                                <TextBlock Text="Follow System Theme"
                                           Style="{StaticResource SubheaderTextStyle}"/>
                                <TextBlock Text="Automatically match Windows theme settings"
                                           Style="{StaticResource BodyTextStyle}"/>
                            </StackPanel>
                            
                            <CheckBox Grid.Column="1" 
                                      IsChecked="{Binding IsFollowingSystem}"
                                      Style="{StaticResource ToggleSwitchStyle}"
                                      VerticalAlignment="Center"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- About Section -->
                <Border Style="{StaticResource CardStyle}">
                    <StackPanel>
                        <TextBlock Text="ABOUT"
                                   Style="{StaticResource LabelTextStyle}"
                                   Margin="0,0,0,10"/>

                        <TextBlock Text="JF Storage Tester"
                                   Style="{StaticResource SubheaderTextStyle}"/>
                        <TextBlock Style="{StaticResource BodyTextStyle}"
                                   Margin="0,2,0,6">
                            <Run Text="Version "/><Run Text="{Binding CurrentVersion}"/>
                        </TextBlock>
                        <TextBlock Text="A modern storage testing utility for surface verification and speed benchmarking."
                                   Style="{StaticResource BodyTextStyle}"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,12"/>
                        
                        <!-- Update Section -->
                        <Grid Margin="0,0,0,6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel>
                                <TextBlock Text="{Binding UpdateStatus}"
                                           Style="{StaticResource BodyTextStyle}"
                                           Foreground="{DynamicResource SecondaryTextBrush}"/>
                                
                                <!-- Download Progress -->
                                <ProgressBar Value="{Binding DownloadProgress}"
                                             Maximum="100"
                                             Height="4"
                                             Margin="0,4,10,0"
                                             Background="{DynamicResource TertiaryBackgroundBrush}"
                                             Foreground="{DynamicResource AccentBrush}"
                                             Visibility="{Binding IsDownloading, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <!-- Check for Updates Button -->
                                <Button Content="Check for Updates"
                                        Command="{Binding CheckForUpdatesCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Padding="12,6"
                                        FontSize="11"
                                        Visibility="{Binding UpdateAvailable, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                                
                                <!-- Install Update Button (shown when update available) -->
                                <Button Content="Install Update"
                                        Command="{Binding InstallUpdateCommand}"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Padding="12,6"
                                        FontSize="11"
                                        Visibility="{Binding UpdateAvailable, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
        
        <!-- Close Button -->
        <Button Grid.Row="2" 
                Content="Close"
                Style="{StaticResource SecondaryButtonStyle}"
                HorizontalAlignment="Right"
                Margin="0,12,0,0"
                Click="CloseButton_Click"/>
    </Grid>
</Window>

